<html>
    <head>
        <title>Submod</title>
        <link type="text/css" rel="stylesheet" href="static/css/style.css" />

        <script>
            function validate() {
                var input = document.getElementById('subtitlefile');

                var filename = form.subtitlefile.value;
                var ext = filename.substring(filename.lastIndexOf('.') + 1).toLowerCase();
                if (ext != 'srt' && ext != 'vtt')
                {
                    alert('Invalid filetype: ' + ext);
                    input.value = '';
                    return;
                }

                var filesize = Math.round(input.files[0].size/1024); // filesize in kB
                if (filesize > 200)
                {
                    alert('Filesize = ' + filesize + 'kB\nToo large!');
                    input.value = '';
                    return;
                }
            }

            function checkFields() {
                var subtitle = form.subtitlefile.value;
                if (!subtitle) {
                    alert('No subtitle file is selected.');
                    return false;
                }

                var seconds = form.seconds.value;
                if (!seconds) {
                    alert('No seconds are entered.');
                    return false;
                }

                return true;
            }
        </script>
    </head>

    <body>
        <div id="header">
            <div id="inner-header">
                <h1>Movie Subtitle Modifier</h1>
                <b>How this works:</b>
                <ul>
                    <li>Choose your subtitle file (<b>.srt</b> or <b>.vtt</b> extension).</li>
                    <li>Enter the seconds by which to modify the subtitle time encoding.</li>
                    <li>Click convert; the modified subtitle should download automatically.</li>
                </ul>
            </div>
            <hr />
        </div>

        <div id="main">

            <h2>Convert Subtitle</h2>
            <form name="form" action=/convert method=post enctype=multipart/form-data onsubmit="return checkFields();">
                <input type="file" name="subtitlefile" id="subtitlefile" accept=".srt,.vtt" onchange="return validate();"/>
                <select name=plusmin>
                    <option value="1">+</option>
                    <option value="-1">-</option>
                </select>
                <input type="number" step="0.01" min="0" max="600" name="seconds" id="seconds" placeholder="  seconds" />
                <input type="submit" value="Convert"/>
            </form>

            <hr />

            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <ul class=flashes>
                    {% for message in messages %}
                        <li>{{ message }}</li>
                    {% endfor %}
                    </ul>
                {% endif %}
            {% endwith %}

        </div>
    </body>

</html>